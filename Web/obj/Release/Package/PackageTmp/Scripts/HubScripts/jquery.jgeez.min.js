function Character(n,t,i){return _englishString=n,_shiftKey=t,_Index=i,{englishString:_englishString,shiftKey:_shiftKey,index:_Index}}function jGeezAttributes(){return{enabled:{name:"jgeez-enabled",value:!0},englishbutton:{name:"jgeez-englishbutton",value:""},geezbutton:{name:"jgeez-geezbutton",value:""},showtogglebutton:{name:"jgeez-showtogglebutton",value:!0},helpbutton:{name:"jgeez-helpbutton",value:""},showhelpbutton:{name:"jgeez-showhelpbutton",value:!0},toggleshortcut:{name:"jgeez-toggleshortcut",value:"q"}}}var JGeezUtility={isModifier:function(n){for(mod in JGeezUtility.UNICODEModifierMatrix)if(n==JGeezUtility.UNICODEModifierMatrix[mod][0])return!0;return!1},UNICODE:function(n){var r,t;_root=n.englishString.substr(0,1),_modifier=n.englishString.substr(1,1),_shift=n.shiftKey,_caps=_shift&&_root.charCodeAt(0)>96||!_shift&&_root.charCodeAt(0)<=96,_matches=Array(),_rootlower=_root.toLowerCase();for(i in JGeezUtility.UNICODEMatrix)_resemblence=100,_currentunicode=JGeezUtility.UNICODEMatrix[i],_currentunicode[1].toLowerCase()==_rootlower&&(_currentunicode[1]!=_root&&(_resemblence-=20),_currentunicode[2]!=null&&(_resemblence-=5),_currentunicode[2]==_shift&&(_resemblence+=7),_currentunicode[3]!=null&&(_resemblence-=5),_currentunicode[3]==_caps&&(_resemblence+=7),_matches.push({index:i,resemblence:_resemblence,unicode:_currentunicode[0]}));for(_m in _matches)r?_matches[_m].resemblence>r.resemblence&&(r=_matches[_m]):r=_matches[_m];r&&(t=r.unicode);if(t&&_modifier)for(mod in JGeezUtility.UNICODEModifierMatrix)JGeezUtility.UNICODEModifierMatrix[mod][0]==_modifier&&(t=t+JGeezUtility.UNICODEModifierMatrix[mod][1]);return t?String.fromCharCode(t):_root},cIdx:"c_Ch",aIdx:"a_Ch",Print:{isPrintable:function(n){return n>=65&&n<=90||n>=97&&n<=122},newCharacter:function(n,t){rightstr=t.attr("value").substr(0,n.index),leftstr="",n.index<t.attr("value").length&&(leftstr=t.attr("value").substr(n.index,t.attr("value").length-n.index)),t.attr("value",rightstr+JGeezUtility.UNICODE(n)+leftstr),JGeezUtility.Caret.setPosition(t,n.index+1)},replaceCharacter:function(n,t){rightstr=t.attr("value").substr(n.index+1),leftstr="",n.index<t.attr("value").length&&(leftstr=t.attr("value").substr(0,n.index)),t.attr("value",leftstr+JGeezUtility.UNICODE(n)+rightstr),JGeezUtility.Caret.setPosition(t,n.index+1)}},Caret:{getPosition:function(n){var i=0,t;return n=n[0],document.selection?(n.focus(),t=document.selection.createRange(),t.moveStart("character",-n.value.length),i=t.text.length):(n.selectionStart||n.selectionStart=="0")&&(i=n.selectionStart),i},setPosition:function(n,t){n=n[0];if(n.setSelectionRange)n.focus(),n.setSelectionRange(t,t);else if(n.createTextRange){var i=n.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",t),i.select()}}}},jGeezLibraryAttributes;(function(n){n.fn.jGeez=function(i){if(t[i])return t[i].apply(this,Array.prototype.slice.call(arguments,1));if(typeof i!="object"&&i)n.error("Method "+i+" does not exist on jQuery.jGeez");else return t.init.apply(this,arguments)};var t={changeoptions:function(t){var i=n.extend(n(this).data("jGeez"),t);n(this).data("jGeez",t)},init:function(t){function i(t){_options=t.data("jGeez"),__gbtn=n("#"+_options.geezbutton),__ebtn=n("#"+_options.englishbutton),_options.enabled=!_options.enabled,__ebtn&&__gbtn&&(_options.enabled?(__ebtn.show(),__gbtn.hide()):(__ebtn.hide(),__gbtn.show()))}var t=n.extend({showhelpbutton:!0,showtogglebutton:!0,enabled:!0,geezbutton:"",englishbutton:"",helpbutton:"",toggleshortcut:"q"},t);n(this).data("jGeez",t),t.showhelpbutton&&(_help=n("#"+t.helpbutton),_help.attr("href","http://jgeez.com/home/help"),_help.attr("target","_blank")),t.geezbutton&&t.englishbutton&&(_gbtn=n("#"+t.geezbutton),_ebtn=n("#"+t.englishbutton),_gbtn.length>0&&_ebtn.length>0&&(_ebtn.bind("click",{txtbox:n(this)},function(n){i(n.data.txtbox),n.data.txtbox.focus()}),_gbtn.bind("click",{txtbox:n(this)},function(n){i(n.data.txtbox),n.data.txtbox.focus()}),t.showtogglebutton?t.enabled?(_gbtn.hide(),_ebtn.show()):(_gbtn.show(),_ebtn.hide()):(_ebtn.hide(),_gbtn.hide()))),n(this).keyup(function(t){_options=n(this).data("jGeez"),(t.altKey||t.ctrlKey||!JGeezUtility.Print.isPrintable(t.which))&&String.fromCharCode(t.which).toLowerCase()==_options.toggleshortcut.toLowerCase()&&i(n(this))}),n(this).keypress(function(t){var r,i;_options=n(this).data("jGeez");if(t.altKey||t.ctrlKey||!JGeezUtility.Print.isPrintable(t.which))n(this).data(JGeezUtility.aIdx,null);else{if(!_options.enabled)return;r=Character(String.fromCharCode(t.which),t.shiftKey,JGeezUtility.Caret.getPosition(n(this))),n(this).data(JGeezUtility.cIdx,r),i=n(this).data(JGeezUtility.aIdx),i&&i.index+1==r.index?JGeezUtility.isModifier(r.englishString)?(i.englishString+=r.englishString,JGeezUtility.Print.replaceCharacter(i,n(this)),n(this).data(JGeezUtility.aIdx,null)):(i=Character(r.englishString,r.shiftKey,r.index),n(this).data(JGeezUtility.aIdx,i),JGeezUtility.Print.newCharacter(i,n(this))):(i=Character(r.englishString,r.shiftKey,r.index),n(this).data(JGeezUtility.aIdx,i),JGeezUtility.Print.newCharacter(i,n(this))),t.preventDefault()}})}}})(jQuery),JGeezUtility.UNICODEModifierMatrix=[["a",3],["e",5],["i",2],["o",6],["u",1],["y",4],["A",3],["E",5],["I",2],["O",6],["U",1]],JGeezUtility.UNICODEMatrix=[[4608,"h"],[4616,"l"],[4624,"H",!0],[4632,"m"],[4640,"s",!0,!0],[4648,"r"],[4656,"s"],[4664,"S"],[4672,"q"],[4682,"Q"],[4704,"b"],[4712,"v"],[4720,"t"],[4728,"c"],[4736,"h",!0,!0],[4752,"n"],[4760,"N"],[4768,"x"],[4776,"k"],[4792,"h",!0],[4808,"w"],[4816,"x"],[4824,"z"],[4832,"Z"],[4840,"Y"],[4848,"d"],[4856,"P"],[4864,"j"],[4872,"g"],[4896,"T"],[4904,"C"],[4920,"t",!0,!0],[4928,"T",!1,!0],[4936,"f"],[4944,"p"],[4768,"a"],[4769,"u"],[4770,"i"],[4772,"e"],[4774,"o"],[4840,"y"]],jGeezLibraryAttributes={mode:{auto:"auto",manual:"manual"}},$(document).ready(function(){var n,t;_mode=$("script[src*='jgeez']").attr("mode"),n=Math.floor(Math.random()*1e3+1),$("body").append('<span id="s'+n+'" style="width:10px; font-size:30px;overflow:visible;">\u1200</span'),$("body").append('<span id="s'+(n+1)+'" style="width:10px; font-size:30px;overflow:visible;">\u1218</span'),$("#s"+n).width()==$("#s"+(n+1)).width()&&$("<link>").appendTo($("head")).attr({type:"text/css",rel:"stylesheet"}).attr("href","http://www.jgeez.com/cdn/styles/jiret/style.css"),$("#s"+n).remove(),$("#s"+(n+1)).remove(),_mode==jGeezLibraryAttributes.mode.auto&&(t={padding:"0px 6px","font-weight":"bold",cursor:"pointer","margin-left":"1px","text-decoration":"none"},_geezinputs=$("[jgeez-enabled='true']"),_geezinputs.length==0&&(_geezinputs=$("input,textarea")),_geezinputs.each(function(){var i=jGeezAttributes(),f,u,r;$(this).is("["+i.enabled.name+"]")&&(i.enabled.value=$(this).attr(i.enabled.name)=="true"),$(this).is("["+i.englishbutton.name+"]")&&(i.englishbutton.value=$(this).attr(i.englishbutton.name)),$(this).is("["+i.geezbutton.name+"]")&&(i.geezbutton.value=$(this).attr(i.geezbutton.name)),$(this).is("["+i.showtogglebutton.name+"]")&&(i.showtogglebutton.value=$(this).attr(i.showtogglebutton.name)=="true"),$(this).is("["+i.helpbutton.name+"]")&&(i.helpbutton.value=$(this).attr(i.helpbutton.name)),$(this).is("["+i.showhelpbutton.name+"]")&&(i.showhelpbutton.value=$(this).attr(i.showhelpbutton.name)=="true"),$(this).is("["+i.toggleshortcut.name+"]")&&(i.toggleshortcut.value=$(this).attr(i.toggleshortcut.name));if(!i.enabled||$(this).is("input")&&$(this).attr("type")!=undefined&&$(this).attr("type")!="text")return;i.showhelpbutton.value&&(i.helpbutton.value&&(f=$("#"+i.helpbutton.value)),f||(f=$("<a></a>"),f.attr("id","geezhelp_"+n++),f.css(t),f.css({"background-image":"url(../Content/themes/base/images/helpsmall.png)"}),f.html("&nbsp"),f.insertAfter($(this)),$(this).is("textarea")&&f.css({"vertical-align":"top"})),i.helpbutton.value=f.attr("id")),i.showtogglebutton.value&&(i.englishbutton.value&&(u=$("#"+i.englishbutton.value)),u||(u=$("<a></a>"),u.attr("id","englishtoggle_"+n++),u.css(t),u.css({"background-image":"url(http://jgeez.com/Samples/Images/united_kindom.png)"}),u.html("&nbsp"),u.insertAfter($(this)),$(this).is("textarea")&&u.css({"vertical-align":"top"})),i.geezbutton.value&&(r=$("#"+i.geezbutton.value)),r||(r=$("<a></a>"),r.attr("id","geeztoggle_"+n++),r.css(t),r.css({"background-image":"url(http://jgeez.com/Samples/Images/ethiopia_flag.png)"}),r.html("&nbsp"),r.insertAfter($(this)),$(this).is("textarea")&&r.css({"vertical-align":"top"})),i.englishbutton.value=u.attr("id"),i.geezbutton.value=r.attr("id")),$(this).jGeez({englishbutton:i.englishbutton.value,geezbutton:i.geezbutton.value,showtogglebutton:i.showtogglebutton.value,helpbutton:i.helpbutton.value,showhelpbutton:i.showhelpbutton.value,toggleshortcut:i.toggleshortcut.value})}))})